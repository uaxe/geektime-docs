你好，我是Tyler！

今天，我们将继续深入挖掘RAG技术的未来发展。在今天的讨论中，我将引导你通过AI搜索产品来串联本章的核心内容。你会发现，AI搜索平台的进步越来越依赖于交互式学习以及持续优化的反馈循环。

作为当前生成式人工智能领域的重要技术之一，RAG技术已在多个实际应用中展现出其巨大的潜力。随着技术的不断进步，RAG不再仅仅是一个检索-生成模型，而是在AI搜索和智能体两个关键领域实现了突破，朝着更加多样化的方向发展。今天，我们将详细探讨RAG技术在这两个领域的进展和技术细节。

### 从检索增强走向 AI 搜索

RAG技术的核心原理是将检索与生成结合起来。具体来说，RAG不仅依赖预训练模型的语言能力，还能从外部数据库或文档中检索相关信息，并将这些信息与生成模型结合，以提供更准确、有依据的答案。这项技术最初在文本生成领域应用广泛，例如在开放域对话系统中，通过检索外部知识库来增强生成模型的回答质量。

Meta LLaMa3的 [技术报告](https://arxiv.org/abs/2407.21783) 中指出，随着模型规模的扩大，检索与生成的融合能力实现了显著的飞跃。这些大型模型不仅在生成能力上超越了以往的技术，而且在信息检索方面，通过多模态输入进一步提升了系统的查询能力。

在之前的课程中，我们讨论了Meta AI最近发布的405B模型。该技术报告强调，随着模型规模的提升，检索与生成的能力实现了显著的突破。那么，这个模型的能力边界究竟在哪里？你可以通过Meta AI的在线对话平台亲自体验这一切。

![图片](https://static001.geekbang.org/resource/image/96/56/963248a0142e3a2e54b83f8c93115156.png?wh=1400x725)

众多企业之所以争相投资开发对话平台，是因为这些平台不仅能够展示尖端的大模型技术，还能通过与用户的互动积累珍贵的数据，从而提升模型的智能水平。这种互动不仅促进了技术的展示，也为模型的持续优化和学习提供了源源不断的动力。而在这背后，AI搜索作为一项重要的发展趋势，正逐渐成为这些平台的核心驱动力。

### AI搜索的智能化与个性化

AI搜索的核心价值在于其超越传统信息检索的能力，它不仅能够根据用户需求生成个性化的答案，还能提供更加智能化和个性化的响应。相较于传统搜索引擎依赖关键词匹配返回静态网页链接，AI搜索引擎通过结合生成模型和信息检索技术，能够提供实时动态、上下文关联性更强的答案。

随着AI生成技术的不断成熟，搜索引擎不再仅仅满足于作为信息检索工具，而是开始融合生成能力，为用户提供更丰富的内容。例如，New Bing和Kimi这样的AI搜索引擎，通过结合大语言模型和智能化检索算法，不仅能帮助用户找到相关信息，还能生成综合的答案，甚至推理并提供解决方案。

![图片](https://static001.geekbang.org/resource/image/4a/2b/4ac4de111361a452ffc9751dcd36022b.png?wh=1920x1080)

同样，2024年11月1日，OpenAI宣布为ChatGPT推出了全新的人工智能搜索体验，标志着ChatGPT正式进军搜索领域。这种“生成+检索”的协同作用，极大地提升了AI搜索引擎的准确性和处理复杂查询的能力。

![图片](https://static001.geekbang.org/resource/image/c0/88/c05ffd0488beb532e47c62b487c3ba88.png?wh=1920x1080)

与传统搜索引擎提供的静态页面链接不同，AI搜索能够理解用户的查询意图，生成相关内容，并根据用户的反馈实时优化生成结果。例如，当用户询问“如何完成某项任务”时，AI能够整合互联网上的各种信息，生成复杂的解决方案。

这种新型的AI搜索产品正在逐步取代传统搜索引擎的简单查询匹配过程，并为用户提供更加智能、实时、定制化的服务。用户不仅能通过搜索找到链接，还能得到经过分析、总结、并生成的详细答案。

### AI 搜索技术的运作方式

在AI搜索中，充分地利用了本章学习的RAG技术，运作过程可以分为以下几个关键阶段：

1. 查询预处理

查询预处理是AI搜索的第一步，主要任务是将用户输入的搜索请求转化为适合检索的查询表示。为了提高检索的准确性和相关性，通常会通过自然语言处理技术（NLP）对查询进行深入分析。这一过程包括以下几个步骤：

- **分词（Tokenization）**：将输入的搜索请求切分成一个个独立的词或子词，以便系统能够理解每个词的意义和上下文。例如，“如何做一道番茄炒蛋”可能被切分为\[“如何”, “做”, “一道”, “番茄”, “炒”, “蛋”\]。

- **命名实体识别（NER）**：从查询中识别出特定的实体，如人名、地名、时间等。这可以帮助系统更好地理解查询的重点。例如，在查询“2024年北京的天气”中，“2024年”是时间实体，“北京”是地名实体。

- **查询意图分析**：除了识别实体，系统还需要理解用户的搜索意图。这通常通过深度学习模型来实现，可以识别出用户希望获得的具体信息类型（如天气、食谱、历史事件等）。这种分析有助于精确匹配相关的文档或知识。


2. 信息检索

一旦查询预处理完成，接下来的任务是通过高效的检索引擎从外部知识库中找到相关信息。在RAG模型中，信息检索是一个至关重要的步骤，它决定了后续生成回答的质量。

- **检索引擎**：RAG模型使用不同的检索方法来从大量的数据中获取与查询相关的信息。常见的检索引擎包括：
  - **BM25**：基于词频和文档频率的检索算法，适用于大规模文本数据。

  - **FAISS（Facebook AI Similarity Search）**：高效的相似度搜索引擎，常用于高维向量空间中的搜索，如通过语义向量表示的文本。

  - **ANN（Approximate Nearest Neighbors）**：一种近似最近邻算法，特别适用于大规模数据集，能够在维度较高的向量空间中迅速找到与查询最相关的信息。
- **外部知识库**：检索引擎通常会从多个外部资源中获取信息，如：
  - **维基百科**：全球最大的开放性知识库，涵盖广泛的主题。

  - **专有数据库**：如行业知识库、科学文献数据库等。

  - **网页数据**：从网络上爬取的网页信息，包括新闻、博客、论坛等。

在这个阶段，目标是从检索的知识库中找到与查询最相关的文档片段或数据点，这些信息将为后续的生成过程提供必要的上下文。

3. 上下文整合

在这一阶段，检索到的文档片段和用户的原始查询被送入生成模型，生成模型会利用这些信息生成最终的回答。这一过程称为 **上下文整合**。生成模型（LLaMA3）不仅根据查询内容生成答案，还会结合检索到的外部信息来增强回答的准确性和细节。

- **上下文融合**：生成模型将检索到的相关信息与用户查询进行融合，这可能涉及到对检索结果进行排序、筛选，并选择最相关的内容作为输入。

- **信息验证**：部分先进的RAG模型还会对检索到的信息进行简单的验证，确保其可信度和准确性。这一过程可以通过额外的模型来完成，防止错误信息的生成。


例如，在查询“如何做一道番茄炒蛋”时，检索引擎可能会返回相关的食谱，而生成模型则会根据这些食谱生成一个连贯、详细的做法步骤。

4. 生成过程

生成过程是RAG模型的核心，在这个阶段，生成模型基于预训练的语言能力以及检索到的外部信息生成最终的答案。

- **生成策略**：生成模型会根据上下文信息（包括查询和检索到的文档片段）来推理和生成回答。在某些情况下，生成模型还可以进行推理，例如回答推测性问题、提供解决方案等。

- **生成质量**：由于RAG结合了信息检索和生成模型，它能够生成更为准确、丰富和符合上下文的答案。相比传统生成模型，RAG能更好地弥补语言模型在某些领域缺乏具体知识的不足，提供更加可信和详细的答案。


例如，针对“如何做一道番茄炒蛋”，生成模型不仅提供菜谱，还能根据地域的差异提供不同的做法（例如加入不同的调味料），使得答案更加个性化。

### 用户交互与持续优化

随着AI搜索产品不断发展， **用户的参与** 成为平台优化的核心因素之一。平台通过与用户的持续互动，不断积累和分析用户的行为数据，以提升模型的智能化水平和用户体验。

- **用户数据收集**：用户与平台的交互（如查询、点击、反馈等）提供了宝贵的数据。这些数据不仅帮助平台更好地理解用户需求，还可以用来优化生成模型和检索算法。随着数据的积累，模型的回答质量会逐渐提高，能够更精准地理解和回应用户的查询。

- **算法优化**：通过对用户行为数据的分析，AI搜索平台能够优化算法，提升信息检索的准确性和生成的相关性。例如，平台可以根据用户的反馈对生成内容进行调整，进一步改善个性化的答案。

- **用户粘性**：这种优化不仅提升了用户体验，还增强了用户粘性，促进了平台的长期使用。通过不断提高服务质量和提供更为智能的搜索体验，平台能够保持在竞争激烈的市场中的优势地位。


### 总结

学到这里，我们做个总结吧。在未来，随着RAG技术的不断进步，AI搜索将不再仅仅是信息检索工具，而会成为一个智能的、实时的、个性化的服务平台，为用户提供更加精准和定制化的查询体验。

RAG技术的发展可以说是一体两面的，它在AI搜索和智能体（Agent）技术中扮演着双重角色。从AI搜索的角度来看，RAG是一个高效的信息整合过程，它能够将搜索到的内容与查询需求结合，生成精确的答案。但从智能体的角度来看，RAG则成为了智能体的重要外部记忆来源，极大地拓展了智能体的能力边界。

随着技术的不断进步，Agent智能体正在逐步获得记忆能力，能够在多次交互中积累知识、记住用户的偏好，并根据这些信息进行更有针对性的服务。RAG技术在这个过程中起到了至关重要的作用，它为智能体的外部记忆和推理能力提供了有力支持，使智能体不仅能在即时查询中给出答案，还能基于过去的知识为用户提供定制化、持续优化的服务。

本章内容学习完成后，你已具备了“闯关”下一章智能体的全部前序知识，恭喜你完成本章的学习，我们下一章见。

### 思考题

请你说一说你对“RAG技术是一体两面的”这种说法的看法，欢迎你把你的想法分享到留言区，也欢迎你把这节课的内容分享给其他朋友，我们下节课再见！