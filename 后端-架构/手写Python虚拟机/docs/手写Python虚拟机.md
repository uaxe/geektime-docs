由于国内芯片自主研发进程加快，各个公司开始筹建自己的编译器团队以开发特定领域的大模型，这一趋势显著增加了 AI 编译器领域对专业人才的需求。但在传统教育体系下走入社会的开发工程师大多不具备自己独立设计并优化编译器和虚拟机的能力，在遇到内存管理、性能调试等生产问题时往往不知所措。

那如何才能具备这样的能力呢？

海纳作为一名拥有多年编译器开发经验的技术专家，经过多年的探索和实践，发现 **动手写一个虚拟机是快速上手编译开发的最优的路线**。通过手写 Python 虚拟机，你可以获得从宏观到微观多维度的编程能力。

- 深入了解编程语言的工作原理和执行流程。
- 掌握编译原理，特别是编译器的前端和后端工作机制。
- 了解如何优化虚拟机的性能，包括 JIT 编译技术和内存管理策略。
- 实现虚拟机的内存管理模块，掌握自动垃圾回收算法和内存分配策略。
- 通过构建一个完整的虚拟机项目，体验软件工程从设计、编码到测试和维护的全过程。

在课程中，海纳会带你一步步实现一个自己的 Python 虚拟机，每一环节都会配备详尽的示例代码，并融入他在行业内积累的宝贵经验和设计决策背后的思考。

### 课程设计

为了让整个项目既环环相扣，又有一定的独立性，海纳按照不同的模块将课程分成了 6 个章节。

![](https://static001.geekbang.org/resource/image/2c/bf/2c9600efe3e6fc7yy2877441afa26fbf.png?wh=2910x1102)

**第一章 编程语言的发展历程与基本架构**

这一章海纳老师会带你深入探讨虚拟机的起源与演进，了解它的核心优势，学习编译器是如何将源代码转化为字节码的，你还可以通过实例看到虚拟机的执行过程，包括字节码序列化、解释执行及 JIT 编译技术。这些都是 Python 虚拟机相关的背景知识，是后面具体实操的理论基础。

**第二章 控制流**

学完这一章的内容，你会了解到 Python 字节码指令集、字节码文件的格式、虚拟机如何对字节码文件进行加载等内容。然后就可以实现最基本的控制流了，例如分支结构、循环结构。也就是说，虚拟机已经具备了基本的计算能力。

**第三章 函数的实现机制**

函数作为 Python 语言的第一类公民，可以做为参数传递给其他函数，也可以做为返回值被传出函数之外。这是函数式编程最基本的特性，但要实现函数式编程，还需要理解自由变量、闭包等特性，所以这一章你会全面了解语言虚拟机是如何实现这些高级特性的。

**第四章 对象系统和语言内建对象**

面向对象编程的三大特征是封装、继承和多态。在这一章中，你会看到虚拟机是如何实现通过类型创建对象，以及如何表达类型之间的继承关系这些基本内容的，然后进一步掌握运行时识别、函数覆写、操作符重载等面向对象编程中的高级主题。

**第五章 内存管理与垃圾回收**

这一章你会学到 Python 对象的内存分配策略，包括静态分配与动态分配的原理与实现。同时也对垃圾回收算法（如引用计数、标记清除、分代回收）的选择与实现有初步的了解。垃圾回收算法是一个独立且庞大的体系，而这一章将成为你学习垃圾回收算法的第一课，带你轻松走进内存管理知识殿堂。

**第六章 异常、迭代、模块系统**

异常、迭代、模块系统等高级主题相对独立，但同时也有一些依赖关系。在前五章的基础上，你完全有能力自己设计并实现这些主题。所以这一部分的内容相对简略，以说明架构设计为主，你可以根据课程中给出的架构设计，自己动手实现这些高级特性。